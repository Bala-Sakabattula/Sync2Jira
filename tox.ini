[tox]
envlist = py39,py312,lint,black,isort

[testenv]
setenv =
    DEFAULT_FROM = mock_email@mock.com
    DEFAULT_SERVER = mock_server
    INITIALIZE=1
basepython =
    py312: python3.12
    py39: python3.9
deps =
    -r{toxinidir}/requirements.txt
    -r{toxinidir}/test-requirements.txt
sitepackages = True
allowlist_externals = /usr/bin/flake8,/usr/bin/black
commands =
    coverage run -m pytest {posargs} --ignore=tests/integration_tests
# Add the following line locally to get an HTML report --cov-report html:htmlcov-py312

[testenv:lint]
skip_install = true
deps =
    flake8
commands =
    flake8 sync2jira --max-line-length=140

[isort]
profile = black

[testenv:black]
skip_install = true
deps = black
commands = black --check --diff {posargs:.}

[testenv:black-format]
# this step format code automatically based on black rules
# it can be triggered manually
skip_install = true
deps = black
commands = black {posargs:.}

[testenv:isort]
skip_install = true
deps = isort
commands = isort --check --diff {posargs:.}
